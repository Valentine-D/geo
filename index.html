<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
    <!--<script>
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(locationSuccess, locationError,{
                // 指示浏览器获取高精度的位置，默认为false
                enableHighAccuracy: true,
                // 指定获取地理位置的超时时间，默认不限时，单位为毫秒
                timeout: 5000,
                // 最长有效期，在重复获取地理位置时，此参数指定多久再次获取位置。
                maximumAge: 3000
            });
        }else{
            alert("Your browser does not support Geolocation!");
        }

        locationError: function(error){
            switch(error.code) {
                case error.TIMEOUT:
                    showError("A timeout occured! Please try again!");
                    break;
                case error.POSITION_UNAVAILABLE:
                    showError('We can\'t detect your location. Sorry!');
                    break;
                case error.PERMISSION_DENIED:
                    showError('Please allow geolocation access for this to work.');
                    break;
                case error.UNKNOWN_ERROR:
                    showError('An unknown error occured!');
                    break;
            }
        }

        locationSuccess: function(position){
            var coords = position.coords;
            var latlng = new google.maps.LatLng(
                // 维度
                coords.latitude,
                // 精度
                coords.longitude
            );
            var myOptions = {
                // 地图放大倍数
                zoom: 12,
                // 地图中心设为指定坐标点
                center: latlng,
                // 地图类型
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            // 创建地图并输出到页面
            var myMap = new google.maps.Map(
                document.getElementById("map"),myOptions
            );
            // 创建标记
            var marker = new google.maps.Marker({
                // 标注指定的经纬度坐标点
                position: latlng,
                // 指定用于标注的地图
                map: myMap
            });
            //创建标注窗口
            var infowindow = new google.maps.InfoWindow({
                content:"您在这里<br/>纬度："+
                    coords.latitude+
                    "<br/>经度："+coords.longitude
            });
            //打开标注窗口
            infowindow.open(myMap,marker);
        }
    </script>-->
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=1.4"></script>


    <script>
        /*************js实现*************/
        if(navigator.geolocation){
            navigator.geolocation.getCurrentPosition(getPositionSuccess, getPositionError);
        }else{
            alert("您的浏览器不支持自动定位!");
        }
        /***用户定位成功**/
        function getPositionSuccess(position){
            var lat = position.coords.latitude;
            var lng = position.coords.longitude;
            var address="";


//通过baiduMap API获取街道名称
            var map = new BMap.Map("allmap");
            var point = new BMap.Point(lng,lat);
            var gc = new BMap.Geocoder();
            gc.getLocation(point, function(rs){
                var addComp = rs.addressComponents;
                address = addComp.city + addComp.district + addComp.street + addComp.streetNumber;
                alert("longitude="+lng+"atitude="+lat);
                alert("address="+address);
            });


        }




        /**用户定位失败**/
        function getPositionError(error){
            switch(error.code){
                case error.TIMEOUT:
                    alert("连接超时，请重试");
                    break;
                case error.PERMISSION_DENIED:
                    alert("您拒绝了使用位置共享服务，查询已取消");
                    break;
                case error.POSITION_UNAVAILABLE:
                    alert("亲爱的火星网友，非常抱歉，我们暂时无法为您所在的星球提供位置服务");
                    break;
            }
        }
    </script>
</body>
</html>
